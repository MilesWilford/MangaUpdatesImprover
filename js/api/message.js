var Message;try{Message=function(a){var h=null,f={};var d=(a.manifest.runiniframe=="true");var b=0;function i(l){var j=l;if(IsDefined(UserReport)&&IsDefined(l)){var k=(l.hasOwnProperty("name")&&IsDefined(l.name))?l.name:"Message UserCallback";j=UserReport.surroundCallbackWithTryCatch(l,k);}return j;}function c(k,l,j){l=(typeof(l)==="undefined")?false:l;j=(typeof(j)==="undefined")?true:j;return{message:k,to_iframe:(d&&l),to_top_window:j};}var g=function(k,l,j){if(typeof(Crossrider)==="undefined"){InternalMessaging.messageToBackground({action:"message",params:[k,l,h]});}else{Crossrider.message(k,l);}};this.setTabId=function(j){h=j;};this.toActiveTab=function(k,j){j=typeof(j)==="undefined"?true:j;g("active",c(k,j),h);};this.toAllTabs=function(k,j){j=typeof(j)==="undefined"?true:j;g("all",c(k,j),h);};this.toAllOtherTabs=function(k,j){j=typeof(j)==="undefined"?true:j;g("allOtherTabs",c(k,j),h);};this.toBackground=function(j){g("background",c(j),h);};this.toCurrentTabWindow=function(j){g("to_tab",c(j),h);};this.toCurrentTabIframes=function(l){var k=true;var j=true;g("to_tab",c(l,k,!j),h);};this.toPopup=function(j){g("popup",c(j),h);};this.call=function(l){var j=(window.top!==window.self);if((!j&&!l.to_top_window)||(j&&(!l.to_iframe||!d))){return;}for(var k in f){if(f.hasOwnProperty(k)){if(f[k].isPopup===true&&l.isToPopup===true){if(chrome.extension.getViews({type:"popup"}).length>0){f[k].callback(l.message);}}else{if(f[k].isPopup!==true&&l.isToPopup!==true){f[k].callback(l.message);}}}}};this.addListener=function(j){if(typeof j!="undefined"&&typeof j=="function"){j=i(j);++b;f[b]={callback:j};return b;}};this.removeListener=function(j){if(typeof(j)==="undefined"){f={};return true;}if(f.hasOwnProperty(j)){delete f[j];return true;}return false;};this._addListenerToPopup=function(j){if(typeof j!="undefined"&&typeof j=="function"){j=i(j);++b;f[b]={callback:j,isPopup:true};return b;}};this._removePopupListeners=function(){for(var j in f){if(f.hasOwnProperty(j)){if(f[j].isPopup===true){delete f[j];}}}};return this;};}catch(e){Reports.error(new ErrorMessage(e,"Message init"));}var InternalMessaging;try{InternalMessaging=(function(){function b(){return typeof(Crossrider)!=="undefined";}function f(g){var h=new Error(IsDefined(g)?g:"message undefined");Reports.error(new ErrorMessage(h,"InternalMessaging->sendMesage"));}function d(h){var g=true;if(!IsDefined(h)||!h.hasOwnProperty("action")){f(IsDefined(h)?"message missing action":undefined);g=false;}else{if((typeof h.action!=="string")||(h.action.length<=0)){f("action string error");g=false;}}return g;}function c(g,h,i){if(d(h)){if(typeof i==="function"){chrome.tabs.sendRequest(g,h,i);}else{chrome.tabs.sendRequest(g,h);}}}function a(g,h){if(d(g)){if(typeof h==="function"){chrome.extension.sendRequest(g,h);}else{chrome.extension.sendRequest(g);}}}return{messageToPage:function(g,h,i){if(typeof chrome.tabs.sendMessage==="undefined"){c(g,h,i);}else{if(d(h)){if(typeof i==="function"){chrome.tabs.sendMessage(g,h,i);}else{chrome.tabs.sendMessage(g,h);}}}},messageToBackground:function(g,h){if(typeof chrome.extension.sendMessage==="undefined"){a(g,h);}else{if(d(g)){if(typeof h==="function"){chrome.extension.sendMessage(g,h);}else{chrome.extension.sendMessage(g);}}}},responseLater:true};}());}catch(e){Reports.error(new ErrorMessage(e,"InternalMessaging init"));}
