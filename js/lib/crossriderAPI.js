var CrossriderAPI={fireExtensionEvent:function(b,a,d){d=d?CrossriderAPI.JSON.stringify(d):"__crossrider_empty";b.setAttribute("crossrider_data_store_temp",d);if(window.attachEvent){b.setAttribute("fake_"+a,Math.random());}if(document.createEvent){var c=document.createEvent("Events");c.initEvent("fake_"+a,true,false);b.dispatchEvent(c);}},bindExtensionEvent:function(c,a,d){function b(e){var f;if(e.getAttribute("crossrider_data_store_temp")!="__crossrider_empty"){f=CrossriderAPI.JSON.parse(e.getAttribute("crossrider_data_store_temp"));return f;}else{return null;}}if(window.attachEvent){c.attachEvent("onpropertychange",function(){if(event.propertyName=="fake_"+a){d.call(c,event,b(c));}});}else{c.addEventListener("fake_"+a,function(f){d.call(c,f,b(c));},false);}},isAppInstalled:function(a,b){CrossriderAPI.isAppReady(a,b);},isAppReady:function(a,b){CrossriderAPI.ready(function(){var f=new Date().getTime(),c=document.getElementsByTagName("body")[0],e=false,d=function(){if(e){b(true);}else{if(new Date().getTime()-f<=4000){CrossriderAPI.fireExtensionEvent(c,"__CR_REQUEST_READY");setTimeout(d,100);}else{b(false);}}};CrossriderAPI.bindExtensionEvent(c,"__CR_RESPONSE_READY",function(h,g){if(a==g.appId){e=true;}});setTimeout(d,100);});}};if(window.jQuery&&window.jQuery.fn){window.jQuery.fn.fireExtensionEvent=function(a,b){return this.each(function(){CrossriderAPI.fireExtensionEvent(this,a,b);});};window.jQuery.fn.bindExtensionEvent=function(a,b){return this.each(function(){var c=function(f,d){b(jQuery.event.fix(f),d);};CrossriderAPI.bindExtensionEvent(this,a,c);});};CrossriderAPI.ready=jQuery(document).ready;}else{CrossriderAPI.ready=function(a){CrossriderAPI.readyCallback=a;if(CrossriderAPI.DOMLoaded){CrossriderAPI.readyCallback();}};CrossriderAPI.fireReady=function(){if(CrossriderAPI.DOMLoaded){return;}if(!document.body){return setTimeout(CrossriderAPI.fireReady,1);}CrossriderAPI.DOMLoaded=true;if(CrossriderAPI.readyCallback){CrossriderAPI.readyCallback();}};CrossriderAPI.initReady=function(){if(document.readyState==="complete"){return setTimeout(CrossriderAPI.fireReady,1);}if(document.addEventListener){document.addEventListener("DOMContentLoaded",CrossriderAPI.DOMContentLoaded,false);window.addEventListener("load",CrossriderAPI.fireReady,false);}else{if(document.attachEvent){document.attachEvent("onreadystatechange",CrossriderAPI.DOMContentLoaded);window.attachEvent("onload",CrossriderAPI.fireReady);}}};if(document.addEventListener){CrossriderAPI.DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",CrossriderAPI.DOMContentLoaded,false);CrossriderAPI.fireReady();};}else{if(document.attachEvent){CrossriderAPI.DOMContentLoaded=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",CrossriderAPI.DOMContentLoaded);CrossriderAPI.fireReady();}};}}CrossriderAPI.initReady();}CrossriderAPI.JSON={};(function(){function k(a){return 10>a?"0"+a:a;}function o(a){p.lastIndex=0;return p.test(a)?'"'+a.replace(p,function(a){var c=r[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+a+'"';}function m(a,i){var c,d,h,n,g=e,f,b=i[a];b&&"object"===typeof b&&"function"===typeof b.to_Crossrider_JSON&&(b=b.to_Crossrider_JSON(a));"function"===typeof j&&(b=j.call(i,a,b));switch(typeof b){case"string":return o(b);case"number":return isFinite(b)?""+b:"null";case"boolean":case"null":return""+b;case"object":if(!b){return"null";}e+=l;f=[];if("[object Array]"===Object.prototype.toString.apply(b)){n=b.length;for(c=0;c<n;c+=1){f[c]=m(c,b)||"null";}h=0===f.length?"[]":e?"[\n"+e+f.join(",\n"+e)+"\n"+g+"]":"["+f.join(",")+"]";e=g;return h;}if(j&&"object"===typeof j){n=j.length;for(c=0;c<n;c+=1){d=j[c],"string"===typeof d&&(h=m(d,b))&&f.push(o(d)+(e?": ":":")+h);}}else{for(d in b){Object.hasOwnProperty.call(b,d)&&(h=m(d,b))&&f.push(o(d)+(e?": ":":")+h);}}h=0===f.length?"{}":e?"{\n"+e+f.join(",\n"+e)+"\n"+g+"}":"{"+f.join(",")+"}";e=g;return h;}}if("function"!==typeof Date.prototype.to_Crossrider_JSON){Date.prototype.to_Crossrider_JSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+k(this.getUTCMonth()+1)+"-"+k(this.getUTCDate())+"T"+k(this.getUTCHours())+":"+k(this.getUTCMinutes())+":"+k(this.getUTCSeconds())+"Z":null;},String.prototype.to_Crossrider_JSON=Number.prototype.to_Crossrider_JSON=Boolean.prototype.to_Crossrider_JSON=function(){return this.valueOf();};}var q=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,l,r={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if("function"!==typeof CrossriderAPI.JSON.stringify){CrossriderAPI.JSON.stringify=function(a,i,c){var d;l=e="";if("number"===typeof c){for(d=0;d<c;d+=1){l+=" ";}}else{"string"===typeof c&&(l=c);}if((j=i)&&"function"!==typeof i&&("object"!==typeof i||"number"!==typeof i.length)){throw Error("Crossrider_JSON.stringify");}return m("",{"":a});};}if("function"!==typeof CrossriderAPI.JSON.parse){CrossriderAPI.JSON.parse=function(a,e){function c(a,d){var g,f,b=a[d];if(b&&"object"===typeof b){for(g in b){Object.hasOwnProperty.call(b,g)&&(f=c(b,g),void 0!==f?b[g]=f:delete b[g]);}}return e.call(a,d,b);}var d,a=""+a;q.lastIndex=0;q.test(a)&&(a=a.replace(q,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return d=eval("("+a+")"),"function"===typeof e?c({"":d},""):d;}throw new SyntaxError("Crossrider_JSON.parse");};}})();function initResourceApi(a){CrossriderAPI.bindExtensionEvent(document.body,"__activateCallback__",function(c,b){if(typeof b!=="undefined"&&typeof b.callbackId==="number"&&typeof __callbacksMap__[b.callbackId]==="function"){__callbacksMap__[b.callbackId].apply(this,b.params);}});CrossriderAPI.bindExtensionEvent(document.body,"__activateCrossriderMain__",function(c,b){if(typeof crossriderMain==="function"){crossriderMain(a);}});__callbacksMap__={};__callbackIdCounter__=0;appAPI={};appAPI.db={};appAPI.db.async={};appAPI.db.async.set=function(c,d,b,e){b=b.toString();__callbacksMap__[++__callbackIdCounter__]=e;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.set",params:[c,d,b],callbackId:__callbackIdCounter__});};appAPI.db.async.get=function(b,c){__callbacksMap__[++__callbackIdCounter__]=c;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.get",params:[b],callbackId:__callbackIdCounter__});};appAPI.db.async.getExpiration=function(b,d){var c=function(e){e=new Date(e);d(e);};__callbacksMap__[++__callbackIdCounter__]=c;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.getExpiration",params:[b],callbackId:__callbackIdCounter__});};appAPI.db.async.getList=function(b){__callbacksMap__[++__callbackIdCounter__]=b;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.getList",params:[],callbackId:__callbackIdCounter__});};appAPI.db.async.getKeys=function(b){__callbacksMap__[++__callbackIdCounter__]=b;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.getKeys",params:[],callbackId:__callbackIdCounter__});};appAPI.db.async.remove=function(b,c){__callbacksMap__[++__callbackIdCounter__]=c;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.remove",params:[b],callbackId:__callbackIdCounter__});};appAPI.db.async.removeAll=function(b){__callbacksMap__[++__callbackIdCounter__]=b;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.removeAll",params:[],callbackId:__callbackIdCounter__});};appAPI.db.async.setFromRemote=function(d,e,c,h,g){c=c.toString();__callbacksMap__[++__callbackIdCounter__]=h;var f=__callbackIdCounter__;__callbacksMap__[++__callbackIdCounter__]=g;var b=__callbackIdCounter__;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.setFromRemote",params:[d,e,c],success:f,fail:b});};appAPI.db.async.updateExpiration=function(c,b,d){b=b.toString();__callbacksMap__[++__callbackIdCounter__]=d;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.db.async.getExpiration",params:[c,b],callbackId:__callbackIdCounter__});};appAPI.message={};appAPI.message.addListener=function(b,c){if(typeof b==="function"){__callbacksMap__[++__callbackIdCounter__]=b;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.addListener",params:[],callbackId:__callbackIdCounter__});return;}__callbacksMap__[++__callbackIdCounter__]=c;CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.addListener",params:[b],callbackId:__callbackIdCounter__});};appAPI.message.removeListener=function(b){CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.removeListener",params:[b]});};appAPI.message.toActiveTab=function(c,b){CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.toActiveTab",params:[c,b]});};appAPI.message.toAllTabs=function(c,b){CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.toAllTabs",params:[c,b]});};appAPI.message.toAllOtherTabs=function(c,b){CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.toAllOtherTabs",params:[c,b]});};appAPI.message.toBackground=function(c,b){CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.toBackground",params:[c,b]});};appAPI.message.toPopup=function(c,b){CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.toPopup",params:[c,b]});};appAPI.message.toCurrentTabIframes=function(c,b){CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.toCurrentTabIframes",params:[c,b]});};appAPI.message.toCurrentTabWindow=function(c,b){CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.message.toCurrentTabWindow",params:[c,b]});};appAPI.request={};appAPI.request.get=function(c){if(typeof c==="object"){__callbacksMap__[++__callbackIdCounter__]=c.onSuccess;var d=__callbackIdCounter__;__callbacksMap__[++__callbackIdCounter__]=c.onFailure;var b=__callbackIdCounter__;var e={url:c.url,additionalRequestHeaders:c.additionalRequestHeaders};CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.request.get",params:[e],success:d,fail:b});}};appAPI.request.post=function(c){if(typeof c==="object"){__callbacksMap__[++__callbackIdCounter__]=c.onSuccess;var d=__callbackIdCounter__;__callbacksMap__[++__callbackIdCounter__]=c.onFailure;var b=__callbackIdCounter__;var e={url:c.url,additionalRequestHeaders:c.additionalRequestHeaders,postData:c.postData,contentType:c.contentType};CrossriderAPI.fireExtensionEvent(document.body,"__activateAppApi__",{funcName:"appAPI.request.post",params:[e],success:d,fail:b});}};}
